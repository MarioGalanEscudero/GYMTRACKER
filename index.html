<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IRON TRACKER - Hardcore Gym</title>
    <style>
        :root {
            --bg-dark: #121212;
            --card-bg: #1e1e1e;
            --neon-yellow: #dfff11;
            --neon-border: #333;
            --text-gray: #b3b3b3;
            --danger: #ff4444;
            --success: #dfff11; /* En este tema, el amarillo es el éxito */
        }

        body { 
            font-family: 'Arial Black', Gadget, sans-serif; 
            background-color: var(--bg-dark);
            background-image: radial-gradient(#222 1px, transparent 1px);
            background-size: 20px 20px;
            margin: 0; 
            padding: 10px; 
            color: white;
            text-transform: uppercase;
        }

        .container { max-width: 500px; margin: auto; }
        
        /* HEADER ROTO */
        header {
            text-align: center;
            border-bottom: 4px solid var(--neon-yellow);
            margin-bottom: 20px;
            padding: 10px;
            transform: skewX(-5deg);
        }

        h1 { margin: 0; font-size: 2rem; letter-spacing: -1px; font-style: italic; color: var(--neon-yellow); }

        /* MENÚ ESTILO BOTONES INDUSTRIALES */
        .menu { display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; margin-bottom: 20px; }
        .menu-btn { 
            padding: 15px 5px; 
            border: 2px solid var(--neon-border); 
            background: #111; 
            color: var(--text-gray); 
            cursor: pointer; 
            font-weight: bold; 
            font-size: 0.7rem;
            transition: 0.2s;
        }
        .menu-btn.active { 
            background: var(--neon-yellow); 
            color: black; 
            border-color: var(--neon-yellow);
            box-shadow: 0 0 15px rgba(223, 255, 17, 0.4);
        }

        /* SECCIONES */
        .section { 
            display: none; 
            background: var(--card-bg); 
            padding: 20px; 
            border: 1px solid #333;
            box-shadow: 10px 10px 0px #000;
        }
        .section.active { display: block; }

        h2 { margin-top: 0; font-size: 1rem; color: var(--neon-yellow); border-left: 5px solid var(--neon-yellow); padding-left: 10px; }

        /* INPUTS ESTILO ROUGH */
        input, select, textarea { 
            width: 95%; 
            padding: 12px; 
            margin: 10px 0; 
            border: 1px solid #444; 
            background: #000; 
            color: var(--neon-yellow); 
            font-family: 'Courier New', Courier, monospace;
            font-weight: bold;
        }

        button.add-btn { 
            width: 100%; 
            background: transparent; 
            color: var(--neon-yellow); 
            border: 2px solid var(--neon-yellow); 
            padding: 15px; 
            cursor: pointer; 
            font-weight: bold;
            font-size: 1rem;
            margin-top: 10px;
            transition: 0.3s;
        }
        button.add-btn:hover { background: var(--neon-yellow); color: black; }

        /* CALENDARIO ESTILO REJILLA METÁLICA */
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; margin-top: 10px; }
        .day { 
            padding: 10px 0; 
            background: #222; 
            border: 1px solid #333; 
            cursor: pointer; 
            text-align: center;
            font-size: 0.8rem;
        }
        .day.done { background: var(--neon-yellow); color: black; font-weight: bold; }
        .day.missed { border-color: var(--danger); color: var(--danger); opacity: 0.5; }
        .day.selected { border: 2px solid white; box-shadow: 0 0 10px white; }

        /* HISTORIAL */
        .history-card { background: #111; padding: 10px; border: 1px solid #333; margin-bottom: 10px; }
        .series-row { display: flex; gap: 5px; margin-bottom: 5px; font-size: 0.8rem; border-bottom: 1px solid #222; padding: 5px 0; }
        .diet-block { border-left: 3px solid var(--neon-yellow); padding-left: 10px; margin-bottom: 15px; }
        .diet-label { font-size: 0.7rem; color: var(--neon-yellow); }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>GYMTRACKER</h1>
    </header>

    <div class="menu">
        <button class="menu-btn active" onclick="showSection('ejercicios', this)">[ GYM ]</button>
        <button class="menu-btn" onclick="showSection('dieta', this)">[ DIETA ]</button>
        <button class="menu-btn" onclick="showSection('calendario', this)">[ AGENDA ]</button>
    </div>

    <div id="ejercicios" class="section active">
        <h2>REGISTRAR SESIÓN</h2>
        <input type="text" id="ex-nombre" placeholder="EJERCICIO">
        <label style="font-size: 0.7rem;">Nº SERIES:</label>
        <select id="num-series" onchange="generarCamposSeries()">
            <option value="1">1</option><option value="2">2</option><option value="3">3</option>
            <option value="4" selected>4</option><option value="5">5</option>
        </select>
        <div id="contenedor-series"></div>
        <button class="add-btn" onclick="addEjercicio()">SUBIR DATOS</button>
    </div>

    <div id="dieta" class="section">
        <h2>CARGA NUTRICIONAL</h2>
        <div class="diet-block"><span class="diet-label">DESAYUNO</span><input type="text" id="diet-desayuno"></div>
        <div class="diet-block"><span class="diet-label">COMIDA</span><input type="text" id="diet-comida"></div>
        <div class="diet-block"><span class="diet-label">MERIENDA</span><input type="text" id="diet-merienda"></div>
        <div class="diet-block"><span class="diet-label">CENA</span><input type="text" id="diet-cena"></div>
        <button class="add-btn" onclick="addDieta()">GUARDAR DIETA</button>
    </div>

    <div id="calendario" class="section">
        <h2 id="month-name">CARGANDO...</h2>
        <div class="calendar-grid" id="calendar-grid"></div>
        <div id="details-view" style="margin-top:20px;">
            <h3 id="selected-date-text" style="color:var(--neon-yellow)">SELECCIONA DÍA</h3>
            <div id="day-content"></div>
        </div>
    </div>
</div>

<script>
    let db = JSON.parse(localStorage.getItem('gymDataV4')) || {};
    window.onload = () => { generarCamposSeries(); };

    function showSection(id, btn) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.menu-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        btn.classList.add('active');
        if(id === 'calendario') renderCalendario();
    }

    function generarCamposSeries() {
        const num = document.getElementById('num-series').value;
        const cont = document.getElementById('contenedor-series');
        cont.innerHTML = '';
        for(let i=1; i<=num; i++) {
            cont.innerHTML += `
                <div style="display:flex; gap:5px; margin-bottom:5px;">
                    <div style="width:50px; padding-top:15px; font-size:0.7rem;">S${i}</div>
                    <input type="number" class="peso-serie" placeholder="KG">
                    <input type="number" class="reps-serie" placeholder="REPS">
                </div>`;
        }
    }

    function getTodayKey() {
        const d = new Date();
        return `${d.getFullYear()}-${(d.getMonth()+1).toString().padStart(2,'0')}-${d.getDate().toString().padStart(2,'0')}`;
    }

    function addEjercicio() {
        const nombre = document.getElementById('ex-nombre').value;
        if(!nombre) return;
        let series = [];
        document.querySelectorAll('.peso-serie').forEach((p, i) => {
            series.push({ peso: p.value || 0, reps: document.querySelectorAll('.reps-serie')[i].value || 0 });
        });
        const hoy = getTodayKey();
        if(!db[hoy]) db[hoy] = { ejercicios: [], dieta: {desayuno:'', comida:'', merienda:'', cena:''} };
        db[hoy].ejercicios.push({ nombre, series });
        localStorage.setItem('gymDataV4', JSON.stringify(db));
        alert("SISTEMA ACTUALIZADO");
    }

    function addDieta() {
        const hoy = getTodayKey();
        if(!db[hoy]) db[hoy] = { ejercicios: [], dieta: {} };
        db[hoy].dieta = {
            desayuno: document.getElementById('diet-desayuno').value,
            comida: document.getElementById('diet-comida').value,
            merienda: document.getElementById('diet-merienda').value,
            cena: document.getElementById('diet-cena').value
        };
        localStorage.setItem('gymDataV4', JSON.stringify(db));
        alert("NUTRICIÓN GUARDADA");
    }

    function renderCalendario() {
        const grid = document.getElementById('calendar-grid');
        const ahora = new Date();
        document.getElementById('month-name').innerText = ahora.toLocaleString('es', { month: 'long', year: 'numeric' });
        grid.innerHTML = '';
        const ultimoDia = new Date(ahora.getFullYear(), ahora.getMonth() + 1, 0).getDate();

        for (let i = 1; i <= ultimoDia; i++) {
            const key = `${ahora.getFullYear()}-${(ahora.getMonth()+1).toString().padStart(2,'0')}-${i.toString().padStart(2,'0')}`;
            const ok = db[key] && db[key].ejercicios.length > 0;
            let clase = ok ? 'done' : (i < ahora.getDate() ? 'missed' : '');
            grid.innerHTML += `<div class="day ${clase}" onclick="verDia('${key}', this)">${i}</div>`;
        }
    }

    function verDia(key, el) {
        document.querySelectorAll('.day').forEach(d => d.classList.remove('selected'));
        el.classList.add('selected');
        const d = db[key];
        const cont = document.getElementById('day-content');
        if(!d) { cont.innerHTML = "SIN DATOS"; return; }

        let h = '<p style="color:var(--neon-yellow)">> EJERCICIOS:</p>';
        d.ejercicios.forEach(ex => {
            h += `<div class="history-card"><b>${ex.nombre}</b><br>`;
            ex.series.forEach((s, i) => h += `<span style="font-size:0.7rem">S${i+1}: ${s.peso}KG x ${s.reps} | </span>`);
            h += `</div>`;
        });
        h += '<p style="color:var(--neon-yellow)">> COMIDAS:</p>';
        if(d.dieta) {
            for(let key in d.dieta) if(d.dieta[key]) h += `<div style="font-size:0.8rem; margin-bottom:5px;"><b>${key}:</b> ${d.dieta[key]}</div>`;
        }
        cont.innerHTML = h;
    }
</script>
</body>
</html>